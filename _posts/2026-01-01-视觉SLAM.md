---
layout: post
title: "视觉SLAM"
date:   2026-01-01
tags: [SLAM]
comments: true
author: kwanwaipang
toc: true
excerpt: ""
---

# 原博客

* [Link](https://kwanwaipang.github.io/File/Blogs/Poster/%E8%A7%86%E8%A7%89SLAM.html)

<div id="target-content-placeholder">正在加载...</div>

<script>
(function() {
  if (window.__SLAM_BLOG_LOADED__) return;
  window.__SLAM_BLOG_LOADED__ = true;

  const baseUrl = '/File/Blogs/Poster/'; 
  const filePath = baseUrl + '视觉SLAM.html';

  fetch(filePath)
    .then(res => res.text())
    .then(html => {
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');

      // 1. 彻底移除原 HTML 里的所有目录相关元素，防止干扰
      // 增加常见目录 ID：#toc, .table-of-contents 等
      const toRemove = ['header', '.navbar', '.post-header', 'footer', '#scrollToTocButton', '#toggleTocButton', '#newToc', '#toc', '.toc', '#markdown-toc'];
      toRemove.forEach(s => doc.querySelectorAll(s).forEach(el => el.remove()));

      const rawBody = doc.body.innerHTML;
      const processedHtml = rawBody.replace(/(src|href)="(?!(http|https|\/|#))/g, `$1="${baseUrl}`);

      let styleContent = '';
      doc.querySelectorAll('style, link[rel="stylesheet"]').forEach(s => {
        if (s.tagName === 'LINK') {
          let href = s.getAttribute('href');
          if (href && !href.startsWith('http') && !href.startsWith('/')) s.setAttribute('href', baseUrl + href);
        }
        styleContent += s.outerHTML;
      });

      const target = document.getElementById('target-content-placeholder');
      const shadow = target.attachShadow({ mode: 'open' });
      shadow.innerHTML = styleContent + processedHtml;

      // 2. --- 关键：将标题注入到 Jekyll 主题真实的 TOC 容器中 ---
      setTimeout(() => {
        // 定位 Jekyll 主题生成的标准目录容器
        // 大多数 Jekyll 主题（如 Chirpy, Minima）使用 #markdown-toc 或 .book-toc
        const jekyllToc = document.getElementById('markdown-toc') || 
                          document.querySelector('.post-directory') ||
                          document.querySelector('.toc');
        
        const headings = shadow.querySelectorAll('h1, h2, h3');
        
        if (jekyllToc && headings.length > 0) {
          // 清空 Jekyll 自动生成（可能为空）的内容，由我们填充
          jekyllToc.innerHTML = ''; 
          const ul = document.createElement('ul');
          
          headings.forEach((h, index) => {
            const id = `sec-${index}`;
            h.id = id;
            
            const li = document.createElement('li');
            // 保持 Jekyll 的 class 命名习惯
            const level = h.tagName.toLowerCase();
            
            const a = document.createElement('a');
            a.innerText = h.innerText;
            a.href = "javascript:void(0);";
            a.style.display = "block";
            a.style.paddingLeft = (h.tagName === 'H2' ? '15px' : h.tagName === 'H3' ? '30px' : '0px');
            
            a.onclick = () => {
              h.scrollIntoView({ behavior: 'smooth', block: 'start' });
            };
            
            li.appendChild(a);
            ul.appendChild(li);
          });
          jekyllToc.appendChild(ul);
        }
      }, 300); // 稍微延长等待时间确保 Shadow DOM 渲染完毕
    });
})();
</script>

<style>
/* 样式修饰：让注入的目录符合 Jekyll 常见样式 */
#jekyll-toc-proxy ul {
    list-style: none;
    padding-left: 1.5rem;
    border-left: 2px solid #eee;
}

</style>