---
layout: post
title: "在线游戏之——下棋啦~"
date:   2025-03-14
tags: [Coding]
comments: true
author: kwanwaipang
toc: true
---


<!-- * 目录
{:toc} -->

# 引言
本博文是摸鱼用的，用于在线玩各种棋盘类游戏~~~

* 对应代码请见：[Chess](https://github.com/KwanWaiPang/Chess)


<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->

<style>
/* 移动端优先的棋盘容器 */
.chess-box {
  position: relative;
  width: 95%;
  max-width: 800px;
  margin: 1rem auto;
  background: #f8f9fa;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* 动态宽高比容器 */
.chess-ratio {
  position: relative;
  width: 100%;
  padding-top: 100%; /* 默认1:1 */
}

/* 不同棋类比例 */
.chess-3d { --ratio: 56.25%; }  /* 16:9 */
.chess-chinese { --ratio: 120%; } 
.chess-ratio { padding-top: var(--ratio, 100%); }

.chess-frame {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: 0;
  opacity: 0;
  transition: opacity 0.4s;
}

/* 移动端优化 */
@media (max-width: 768px) {
  .chess-box {
    width: 100%;
    border-radius: 8px;
    margin: 0.5rem auto;
  }
  .chess-chinese { --ratio: 140%; }
}

/* 内联加载动画 */
.loading:after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 40px;
  height: 40px;
  border: 3px solid #ddd;
  border-top-color: #666;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: translate(-50%, -50%) rotate(360deg); }
}
</style>

<script>
// 自执行的匿名函数避免全局污染
(function(){
  // 移动端视口适配
  const setVH = () => {
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  };
  setVH();
  window.addEventListener('resize', setVH);

  // 自动调整iframe
  document.querySelectorAll('.chess-frame').forEach(iframe => {
    const container = iframe.closest('.chess-box');
    const ratioBox = iframe.parentElement;
    
    // 加载处理
    iframe.onload = function() {
      this.style.opacity = 1;
      container.classList.remove('loading');
      
      try {
        // 动态调整高度（需要同源）
        const body = this.contentDocument.body;
        const resizeObserver = new ResizeObserver(() => {
          const height = body.scrollHeight;
          ratioBox.style.paddingTop = `${height / ratioBox.offsetWidth * 100}%`;
        });
        resizeObserver.observe(body);
      } catch(e) {
        // 跨域时使用默认比例
        console.log('使用预设宽高比');
      }
    };

    // 初始化加载状态
    container.classList.add('loading');
  });
})();
</script>

<!-- 国际象棋2D -->
<div class="chess-box">
  <div class="chess-ratio">
    <iframe class="chess-frame"
      src="https://kwanwaipang.github.io/Chess/Western_chess/"
      loading="lazy"
      allowfullscreen>
    </iframe>
  </div>
</div>

<!-- 国际象棋3D -->
<div class="chess-box">
  <div class="chess-ratio chess-3d">
    <iframe class="chess-frame"
      src="https://kwanwaipang.github.io/Chess/Western_chess/index3D.html"
      loading="lazy"
      allowfullscreen>
    </iframe>
  </div>
</div>

<!-- 中国象棋 -->
<div class="chess-box">
  <div class="chess-ratio chess-chinese">
    <iframe class="chess-frame"
      src="https://kwanwaipang.github.io/Chess/Chinese_Chess/"
      loading="lazy"
      allowfullscreen>
    </iframe>
  </div>
</div>
